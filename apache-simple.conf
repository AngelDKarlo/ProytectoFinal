# apache-simple.conf - Configuración simplificada

ServerRoot "/usr/local/apache2"
Listen 80

# Módulos esenciales
LoadModule mpm_event_module modules/mod_mpm_event.so
LoadModule authz_core_module modules/mod_authz_core.so
LoadModule dir_module modules/mod_dir.so
LoadModule mime_module modules/mod_mime.so
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so
LoadModule headers_module modules/mod_headers.so
LoadModule log_config_module modules/mod_log_config.so

# Configuración básica
ServerName localhost
DirectoryIndex index.html
TypesConfig conf/mime.types
DocumentRoot "/usr/local/apache2/htdocs"

# Directorio principal
<Directory "/usr/local/apache2/htdocs">
    Options Indexes FollowSymLinks
    AllowOverride None
    Require all granted
</Directory>

# Logs
ErrorLog /usr/local/apache2/logs/error.log
CustomLog /usr/local/apache2/logs/access.log combined
LogLevel warn

# CORS Headers
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
Header always set Access-Control-Allow-Headers "Content-Type, Authorization"

# Proxy hacia Spring Boot
ProxyPreserveHost On
ProxyRequests Off

# API Proxy
ProxyPass /api/ http://app:8080/api/
ProxyPassReverse /api/ http://app:8080/api/

# Health check simple
<Location "/health">
    SetHandler server-info
    Require all granted
</Location>

# Página de inicio
<Location "/">
    Require all granted
</Location>

# Configuración de seguridad
ServerTokens Prod
ServerSignature Off
